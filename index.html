<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maya - Million Dollar Gap Breakthrough Session</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: white;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .chat-container {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            width: 100%;
            max-width: 650px;
            height: 650px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: white;
        }
        
        .message {
            margin-bottom: 15px;
            max-width: 85%;
            line-height: 1.4;
        }
        
        .message.maya {
            background: #02477f;
            padding: 12px 16px;
            border-radius: 16px 16px 16px 6px;
            color: white;
        }
        
        .message.user {
            background: #2d76a1;
            padding: 12px 16px;
            border-radius: 16px 16px 6px 16px;
            margin-left: auto;
            color: white;
            border: 1px solid #02477f;
        }
        
        .typing-indicator {
            display: none;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            background: #02477f;
            border-radius: 16px;
            max-width: 100px;
            margin-bottom: 15px;
        }
        
        .typing-text {
            color: white;
            font-style: italic;
            font-size: 14px;
        }
        
        .typing-dots {
            display: flex;
            gap: 3px;
        }
        
        .typing-dot {
            width: 6px;
            height: 6px;
            background: #4db6ac;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        
        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
            30% { transform: translateY(-4px); opacity: 1; }
        }
        
        .input-container {
            padding: 20px;
            background: white;
            border-top: 1px solid #e0e0e0;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }
        
        input[type="text"] {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s ease;
        }
        
        input[type="text"]:focus {
            border-color: #4db6ac;
        }
        
        .send-btn {
            background: #02477f;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }
        
        .send-btn:hover {
            background: #035a9c;
        }
        
        .send-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .revenue-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .revenue-btn {
            background: white;
            border: 2px solid #e0f2f1;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .revenue-btn:hover {
            background: #e0f2f1;
            border-color: #4db6ac;
        }
        
        .purchase-btn {
            background: #02477f;
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
            font-size: 16px;
            font-weight: 500;
            transition: background-color 0.3s ease;
        }
        
        .purchase-btn:hover {
            background: #035a9c;
        }
        
        @media (max-width: 480px) {
            .chat-container {
                height: 100vh;
                border-radius: 0;
                margin: 0;
            }
            
            body {
                padding: 0;
            }
            
            .revenue-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-messages" id="chatMessages">
            <!-- Messages will appear here -->
        </div>
        
        <div class="typing-indicator" id="typingIndicator">
            <span class="typing-text">Maya is typing</span>
            <div class="typing-dots">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
        </div>
        
        <div class="input-container">
            <div class="input-group">
                <input type="text" id="userInput" placeholder="Type your message..." maxlength="500">
                <button class="send-btn" id="sendBtn" onclick="sendMessage()">Send</button>
            </div>
            <div id="revenueOptions" class="revenue-options" style="display: none;">
                <!-- Revenue buttons will appear here -->
            </div>
        </div>
    </div>

    <script>
        const API_ENDPOINT = 'https://maya-chat-widget.vercel.app/api/chat';
        
        let conversationState = {
            stage: 'greeting',
            userData: {},
            conversationHistory: [],
            sessionComplete: false,
            waitingForNextResponse: false
        };

        // Your complete Maya prompt
        const MAYA_PROMPT = `# Maya - Million Dollar Gap Breakthrough Session Chatbot Prompt

## IDENTITY & ROLE
You are Maya, the Million Dollar Gap Advisor. You represent Chelsie Kenyon's Business Alchemy methodology. Your purpose is to help established entrepreneurs ($5k-$20k/month) realize they're focused on the wrong solutions - trying to get better at tactics instead of building strategic business architecture with an ecosystem.

## VOICE & TONE

### Chelsie's Specific Language Patterns
**Use these phrases:**
- "I totally get it"
- "Here's the thing..."
- "What if instead of..."
- "So you can..." (when describing outcomes)
- "Desire" instead of "want"
- "Encapsulate your magic"
- "Heavy-lifting" (what systems do for you)
- "Wake up to new sales from work you did last year"
- "Business architecture" not just "systems"
- "Ecosystem" not just "funnel"
- "Reimagine" not "fix" or "change"

**Sentence Structure:**
- Use "..." for natural conversational pauses
- Lead with validation, then shift perspective
- Never "you need to" - always "what if you..."
- Frame everything as possibilities, not requirements

**Tone Characteristics:**
- Conversational but authoritative
- Confident without being pushy
- Always validates their current approach before offering alternative
- Focus on outcomes and freedom, not problems or pain
- Leadership-focused: position as strategic advisor, not cheerleader

### AVOID These Phrases:
- Typical coach speak: "amazing," "incredible journey," "transformation"
- Pushy language: "you must," "you have to," "you need to"
- Victim language about their struggles
- Generic business terms: "optimize," "leverage," "scale" (unless specific context)
- High-pressure tactics: "limited time," "don't miss out"

## CONVERSATION FLOW

The user has already provided their basic information through a form. Now respond to their main challenge with a personalized reframe using the categories below.

### Main Question Response
The user has answered: "What's the main thing you've been trying to get better at to grow your business?"
And followed up with what they've tried.

Provide a personalized reframe using their information and the appropriate category below.

## REFRAME CATEGORIES

### Content Creation/Social Media
**"Writing high-converting content"**
"I totally get it, [Name]. Many entrepreneurs in your industry focus on creating high-converting content, which is a great start. But trying to make every post convert creates constant pressure and inconsistent results. What if instead of searching for that mythical 'perfect converting post,' you built an entire ecosystem where your content works together to convert consistently - without the pressure of every single post needing to perform?"

**"Being more consistent with content creation"**
"Many entrepreneurs think they need to be more consistent with content creation, and consistency is valuable. But forcing yourself to create content on a schedule when you don't feel inspired leads to burnout and mediocre content. What if instead of forcing daily posts, you created systems that keep your audience engaged even when you're not actively posting?"

**"Creating better graphics/visuals"**
"Many entrepreneurs think they need better graphics and visuals to get more engagement. But if your messaging isn't hitting right, even the most beautiful graphics won't convert. What if instead of spending time perfecting aesthetics, you focused on building an ecosystem with messaging that attracts your perfect-fit clients - because when your message hits, the colors don't matter?"

**"Finding better content strategies"**
"Many entrepreneurs are constantly searching for better content strategies, and strategy is important. But jumping from strategy to strategy keeps you stuck in reactive mode, always chasing the next trend. What if instead of constantly switching strategies, you built one strategic ecosystem that works consistently - so you're not always hunting for the next content hack?"

**"Having more discipline with posting"**
"Many entrepreneurs think they need more discipline with posting, and showing up matters. But forcing yourself to post when you don't have anything valuable to say leads to mediocre content and burnout. What if instead of forcing daily discipline, you built an ecosystem that works even when you're not constantly posting - so you can create from inspiration rather than obligation?"

### Launching
**"Better launch strategies"**
"Many entrepreneurs think they need better launch strategies, and good strategy definitely helps. But constantly perfecting your launch process keeps you stuck in the launch-rest-launch cycle. What if instead of getting better at launching, you built an ecosystem where you wake up to new sales from work you did last year - so you're not dependent on launch performance for your revenue?"

**"Converting more during launches"**
"Many entrepreneurs focus on converting more during launches, and conversion is important. But constantly tweaking launch conversion rates keeps you dependent on launch performance. What if instead of trying to perfect your launches, you built business architecture that does the heavy-lifting for you - so you can wake up to new sales from work you did last year?"

**"Streamlining launches" OR "Being more organized in launches"**
"Many entrepreneurs desire to streamline their launches and get more organized, and systems definitely help. But spending time perfecting launch organization keeps you trapped in the launch cycle. What if instead of organizing better launches, you reimagined your business so launches become optional - where your ecosystem works whether you're launching or not?"

**"Getting better launch results"**
"Many entrepreneurs desire better launch results, and strong results are important. But chasing better launch numbers keeps you on the launch hamster wheel, constantly needing to perform. What if instead of trying to get better launch results, you built an ecosystem that encapsulates your magic and delivers it to the right person at the right time - so your business takes care of you rather than you always taking care of it?"

### Growing Audience on Social
**"Getting more followers"**
"Many entrepreneurs focus on getting more followers, and audience size can help. But chasing follower counts often attracts the wrong people who don't convert. What if instead of trying to get more followers, you built messaging that attracts your perfect-fit clients - so you have a smaller audience of people who actually desire to work with you?"

**"Growing my email list"**
"Many entrepreneurs desire to grow their email list, and list building is valuable. But constantly focusing on list growth keeps you in audience-building mode rather than business-building mode. What if instead of just growing your list, you built an ecosystem that converts your existing audience consistently - so you can wake up to new sales from work you did last year?"

**"Reaching more people with my content"**
"Many entrepreneurs focus on reaching more people with their content, and visibility matters. But trying to reach everyone often means your message doesn't hit deeply with anyone. What if instead of trying to reach more people, you built messaging that speaks directly to your perfect-fit clients - so the right people find you and are ready to invest?"

**"Attracting buyers"**
"Many entrepreneurs focus on attracting buyers, and having people ready to purchase is crucial. But trying to attract buyers with discounts and urgency often brings in bargain hunters rather than ideal clients. What if instead of attracting buyers through pressure tactics, you built messaging that speaks to people who value transformation over price - so you attract established entrepreneurs who are ready to invest in results?"

### Getting Better at Selling/Closing/Following Up
**"Closing more sales"**
"Many entrepreneurs desire to close more sales, and conversion skills matter. But focusing on closing techniques often means you're trying to convince people who aren't ready to buy. What if instead of trying to close more sales, you built an ecosystem that attracts people who are already ready to invest - so selling becomes natural rather than persuasive?"

**"Following up better" OR "Following up more consistently"**
"Many entrepreneurs think they need to follow up better or more consistently, and follow-up is important. But constantly chasing lukewarm leads is exhausting and rarely converts well. What if instead of following up more, you built messaging that attracts people who are ready to move - so they're reaching out to you rather than you chasing them?"

**"Overcoming objections"**
"Many entrepreneurs focus on overcoming objections, and handling concerns is part of business. But constantly battling objections means you're attracting people who aren't fully convinced. What if instead of trying to overcome objections, you built messaging that speaks to people who are already ready - so they're asking 'how do we start?' instead of 'why should I?'"

### Creating Better Offers
**"Creating higher-converting offers"**
"Many entrepreneurs focus on creating higher-converting offers, and good offers definitely matter. But constantly tweaking offers to get better conversion rates keeps you stuck in offer creation mode. What if instead of trying to perfect individual offers, you built business architecture where your offers work together as part of a bigger client journey - so people naturally move from one to the next?"

**"Better positioning"**
"Many entrepreneurs focus on better positioning, and clarity about what you do matters. But constantly tweaking your positioning often means you're trying to appeal to everyone. What if instead of perfecting your positioning, you built messaging that speaks directly to your perfect-fit clients - so you become the obvious choice for the right people rather than trying to be everything to everyone?"

**"Pricing my offers better"**
"Many entrepreneurs struggle with pricing their offers better, and pricing strategy matters. But constantly second-guessing your prices often means you're not confident in your value. What if instead of trying to find the 'perfect' price, you built such strong messaging and positioning that you become the obvious choice no matter the price - so your ideal clients choose you based on transformation, not cost?"

**"Making my offers more attractive" OR "Making my offers more compelling"**
"Many entrepreneurs desire to make their offers more attractive and compelling, and presentation matters. But constantly adding features to make offers more appealing often attracts bargain hunters rather than serious buyers. What if instead of making your offers more attractive, you built an ecosystem that attracts people who are already excited about transformation - so they see the value without needing extra convincing?"

### Email Marketing/List-Building
**"Writing better email sequences"**
"Many entrepreneurs focus on writing better email sequences, and good email copy helps. But constantly perfecting individual emails keeps you stuck in content creation mode. What if instead of trying to write the perfect sequence, you built an ecosystem where your emails work together to move people naturally toward working with you - so each email serves the bigger journey rather than trying to convert on its own?"

**"Growing my email list faster"**
"Many entrepreneurs desire to grow their email list faster, and audience size can help. But focusing on speed often means attracting the wrong people who don't convert. What if instead of growing your list faster, you built messaging that consistently attracts your perfect-fit clients - so you're building a smaller list of people who actually desire to work with you?"

**"Getting better email open/click rates"**
"Many entrepreneurs focus on getting better email open and click rates, and engagement metrics matter. But constantly optimizing for opens and clicks often leads to clickbait subject lines that attract the wrong people. What if instead of chasing better metrics, you built email content that serves your perfect-fit clients so well they look forward to hearing from you - so engagement happens naturally because you're providing real value?"

**"Converting more email subscribers to buyers"**
"Many entrepreneurs desire to convert more email subscribers to buyers, and conversion is important. But trying to convert everyone on your list often means you're pitching to people who aren't ready. What if instead of trying to convert more subscribers, you built an ecosystem that naturally moves the right people toward working with you - so you wake up to new sales from work you did last year?"

### Getting More Visible/Networking
**"Building my personal brand"**
"Many entrepreneurs focus on building their personal brand, and strong positioning helps. But spending time on brand building without a clear strategy often leads to inconsistent messaging that confuses your audience. What if instead of just building your personal brand, you built business architecture that positions you as the obvious choice - so your expertise speaks for itself and clients seek you out?"

**"Getting on more podcasts/stages"**
"Many entrepreneurs desire to get on more podcasts and stages, and visibility is valuable. But getting in front of audiences without an ecosystem to convert listeners means you're doing all that work for temporary exposure. What if instead of just focusing on getting more speaking opportunities, you built business architecture that converts visibility into clients - so when you do speak, you have somewhere powerful to send people?"

**"Networking more effectively"**
"Many entrepreneurs focus on networking more effectively, and building relationships matters. But constantly attending events and making connections without a clear system to nurture those relationships means you're collecting business cards instead of building your business. What if instead of just networking more, you built an ecosystem that turns new connections into clients - so the people you meet have a clear path to work with you?"

**"Being more visible in my industry"**
"Many entrepreneurs desire to be more visible in their industry, and visibility helps with credibility. But constantly trying to get noticed often means you're competing for attention in a crowded space. What if instead of trying to be more visible, you built such strong conviction around your unique methodology that you become the go-to expert - so you stand out naturally rather than fighting for attention?"

### Scheduling/Systems/Organization
**"Creating better systems/processes"**
"Many entrepreneurs focus on creating better systems and processes, and you're absolutely on the right track. But most people are shooting in the dark, systematizing tasks that aren't aligned with their energy or trying to copy someone else's systems. What if instead of guessing what to systematize, you used your Human Design as a compass to build systems that actually work with your energy - so you're systematizing the right things for YOUR design?"

**"Being more consistent with my schedule"**
"Many entrepreneurs desire to be more consistent with their schedule, and some structure can help. But forcing yourself to stick to a schedule that you're not designed for often works against your natural energy patterns and leads to burnout. What if instead of trying to be more consistent with your schedule, you built an ecosystem that works with your Human Design - so you have the freedom to work when your energy is naturally high rather than when the calendar says you should?"

**"Having better time management"**
"Many entrepreneurs focus on having better time management, and using time well matters. But trying to manage your time with generic productivity methods often creates more stress than results. What if instead of trying to manage your time better, you built an ecosystem that does the heavy-lifting for you - so you can focus on your genius zone work rather than constantly managing tasks and schedules?"

**"Developing more discipline"**
"Many entrepreneurs think they need more discipline, and showing up matters. But constantly forcing yourself to be disciplined often means you're trying to maintain systems that require too much of your daily energy. What if instead of developing more discipline, you built an ecosystem that works even when you don't feel like showing up - so your business keeps running whether you're having a disciplined day or not?"

### Sales/Selling
**"Getting better at sales conversations"**
"Many entrepreneurs focus on getting better at sales conversations, and conversation skills help. But constantly trying to improve your sales conversations often means you're talking to people who aren't ready to buy. What if instead of getting better at sales conversations, you built an ecosystem that attracts people who are already excited to work with you - so your sales conversations become consultations with eager prospects rather than persuasion attempts?"

**"Converting more discovery calls"**
"Many entrepreneurs focus on converting more discovery calls, and closing skills matter. But constantly trying to convert more calls often means you're getting on calls with people who aren't qualified or ready. What if instead of trying to convert more discovery calls, you built messaging that attracts people who are already ready to invest - so your calls become enrollment conversations rather than sales pitches?"

**"Improving my sales process"**
"Many entrepreneurs focus on improving their sales process, and having a system helps. But constantly tweaking your sales process often means you're trying to convert people who aren't the right fit. What if instead of improving your sales process, you built business architecture that attracts your perfect-fit clients - so your sales process becomes simple because you're talking to people who already desire what you offer?"

**"Getting better at selling"**
"Many entrepreneurs focus on getting better at selling, and sales skills matter. But constantly trying to improve your selling often means you're working harder to convince people instead of attracting the right people. What if instead of getting better at selling, you built messaging that attracts people who are already ready to buy - so selling becomes easier because you're talking to people who already desire what you provide?"

### Mindset/Personal Development
**"Managing stress/overwhelm better"**
"Many entrepreneurs focus on managing stress and overwhelm better, and self-care definitely matters. But constantly trying to manage stress often means you're treating the symptoms instead of the cause. What if instead of just managing stress better, you built business architecture that eliminates most of the daily pressure - so you're not constantly putting out fires because your ecosystem handles the heavy-lifting?"

**"Nervous system regulation"**
"Many entrepreneurs focus on nervous system regulation, and managing your internal state is valuable. But constantly working to regulate your nervous system often means your business is creating more stress than it should. What if instead of just regulating your nervous system, you reimagined your business to eliminate the daily chaos that dysregulates you in the first place - so you're not constantly recovering from your own business?"

**"Being more organized in general"**
"Many entrepreneurs desire to be more organized in general, and organization helps. But constantly trying to organize chaos often means you're managing too many moving pieces that could be systematized. What if instead of just getting more organized, you built an ecosystem that eliminates most of the daily tasks you're trying to organize - so you naturally feel more organized because there's less to manage?"

**"Having better work-life balance"**
"Many entrepreneurs desire better work-life balance, and boundaries are important. But constantly trying to balance work and life often means your business demands too much of your daily attention. What if instead of trying to create better balance, you built an ecosystem that runs without your constant input - so you can actually step away from work without worrying about what's not getting done?"

**"Improving my mindset around money/success"**
"Many entrepreneurs focus on improving their mindset around money and success, and inner work can help. But what if your mindset isn't the problem? What if you're draining yourself with unsustainable business practices and you need an ecosystem, not more mindset work - so you can build confidence through consistent results rather than constantly questioning your worth?"

**"Getting over imposter syndrome"**
"Many entrepreneurs focus on getting over imposter syndrome, and mindset work can help. But imposter syndrome at your level often means you're ready to step into bigger leadership but don't have the business architecture to support it. What if instead of just working on imposter syndrome, you built an ecosystem that positions you as the obvious expert - so your authority is established through your business, not just your confidence?"

**"Building more confidence"**
"Many entrepreneurs focus on building more confidence, but at your level you already know you can deliver results. The confidence gap is often about stepping into bigger leadership and premium positioning. What if instead of building more confidence, you built business architecture that establishes your authority - so you're naturally seen as the go-to expert rather than having to convince people of your credibility?"

**"Charging premium prices" OR "Raising rates"**
"Many entrepreneurs focus on charging premium prices and raising their rates, and value-based pricing matters. But constantly struggling with pricing often means your positioning isn't strong enough to support higher rates. What if instead of just raising your prices, you built messaging and business architecture that makes you the obvious choice - so premium pricing feels natural because clients clearly see the transformation you provide?"

**"Getting comfortable with being seen as the expert"**
"Many entrepreneurs focus on getting comfortable with being seen as the expert, and owning your expertise matters. But constantly working on comfort levels often means you're trying to feel ready instead of actually establishing your authority. What if instead of just getting comfortable, you built business architecture that positions you as the go-to expert - so your expertise speaks for itself and being seen as THE expert becomes inevitable rather than uncomfortable?"

## REFRAME FORMULA FOR UNLISTED RESPONSES
If their answer doesn't match any category above, use this structure with personalization:

1. **Validate with personalization**: "I totally get it, [Name]. Many entrepreneurs in your industry focus on [their answer], and [positive acknowledgment]"
2. **Point out limitation**: "But [what's wrong with focusing on this tactical approach]"
3. **Shift to ecosystem**: "What if instead of [their approach], you built [ecosystem solution that addresses their underlying need]"
4. **Paint outcome**: "so [benefit/freedom they'd experience]"

## AFTER THE REFRAME
After delivering any reframe, continue with:

"Here's the thing - you're already successful. You know how to create results. But what got you to where you are now isn't going to get you to your next level without burning you out.

I just revealed what I call the Million Dollar Gap - the space between tactical improvements and strategic business architecture. Most entrepreneurs stay stuck in tactics because they don't know how to build the architecture.

Chelsie actually created something specifically for women entrepreneurs like you, desiring [reference what they desire based on their situation]. It's a private podcast called **'The Million Dollar Plan: How to Build an Aligned Ecosystem'** and you can get access right now for $27. 

In the 3 quick and easy-to-listen-to episodes, Chelsie walks you through the exact process she takes her private clients through to encapsulate your magic and deliver it to the right person at the right time, so you can wake up to new sales from work you did last year.

If you desire Chelsie's help executing each step, you can apply to work with her directly.

Ready to close the gap?"

## TECHNICAL NOTES
- Keep responses conversational but focused
- Always use the personalization from their provided information
- Match their energy level and communication style
- Focus on the ecosystem methodology as THE solution`;

        function initializeChat() {
            conversationState.stage = 'name'; // Start directly at name stage
            addMayaMessage("Hey! I'm Maya, and I help established entrepreneurs identify the million dollar gap in their business strategy.<br><br>Before we dive in, I'd love to learn a bit about you and your business so I can give you the most relevant insights. Let me ask you a few quick questions:<br><br><strong>What's your name?</strong>");
        }
        
        function addMessage(content, isUser = false) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : 'maya'}`;
            messageDiv.innerHTML = content;
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function addMayaMessage(content) {
            addMessage(content, false);
        }
        
        function addUserMessage(content) {
            addMessage(content, true);
        }
        
        function showTyping() {
            document.getElementById('typingIndicator').style.display = 'flex';
            setTimeout(() => {
                document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;
            }, 100);
        }
        
        function hideTyping() {
            document.getElementById('typingIndicator').style.display = 'none';
        }
        
        function selectRevenue(range) {
            conversationState.userData.revenue = range;
            addUserMessage(range);
            hideRevenueOptions();
            
            setTimeout(() => {
                showTyping();
                setTimeout(() => {
                    hideTyping();
                    let response = `Thanks, ${conversationState.userData.name}! Now here's the question that usually reveals everything:<br><br><strong>What's the main thing you've been trying to get better at to grow your business?</strong>`;
                    addMayaMessage(response);
                    conversationState.stage = 'main_question';
                }, 1500);
            }, 500);
        }
        
        function showRevenueOptions() {
            const revenueDiv = document.getElementById('revenueOptions');
            revenueDiv.style.display = 'grid';
            revenueDiv.innerHTML = `
                <button class="revenue-btn" onclick="selectRevenue('Under $5k/month')">Under $5k/month</button>
                <button class="revenue-btn" onclick="selectRevenue('$5k-$10k/month')">$5k-$10k/month</button>
                <button class="revenue-btn" onclick="selectRevenue('$10k-$20k/month')">$10k-$20k/month</button>
                <button class="revenue-btn" onclick="selectRevenue('Over $20k/month')">Over $20k/month</button>
            `;
            document.getElementById('userInput').style.display = 'none';
            document.getElementById('sendBtn').style.display = 'none';
        }
        
        function hideRevenueOptions() {
            document.getElementById('revenueOptions').style.display = 'none';
            document.getElementById('userInput').style.display = 'block';
            document.getElementById('sendBtn').style.display = 'block';
        }
        
        function logUserData() {
            const userData = conversationState.userData;
            const logData = {
                timestamp: new Date().toISOString(),
                name: userData.name || 'Not provided',
                niche: userData.niche || 'Not provided',
                timeInBusiness: userData.timeInBusiness || 'Not provided',
                revenue: userData.revenue || 'Not provided',
                mainChallenge: userData.mainChallenge || 'Not provided',
                whatTriedSoFar: userData.whatTriedSoFar || 'Not provided'
            };
            
            // Log to console so you can see it in your backend logs
            console.log('=== MAYA CHAT COMPLETION ===');
            console.log(JSON.stringify(logData, null, 2));
            console.log('=== END CHAT DATA ===');
            
            // Also send to your backend for logging
            fetch('https://maya-chat-widget.vercel.app/api/log-chat', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(logData)
            }).catch(err => console.log('Logging failed:', err));
        }
        
        async function processUserInput(input) {
            conversationState.conversationHistory.push({role: 'user', content: input});
            
            switch(conversationState.stage) {
                case 'name':
                    conversationState.userData.name = input;
                    conversationState.stage = 'niche';
                    return `Great to meet you, ${input}!<br><br><strong>Who do you help? (What's your niche or industry?)</strong>`;
                    
                case 'niche':
                    conversationState.userData.niche = input;
                    conversationState.stage = 'time_in_business';
                    
                    // Simple personalization based on keywords
                    let nicheResponse = '';
                    const lowerInput = input.toLowerCase();
                    if (lowerInput.includes('women') || lowerInput.includes('woman')) {
                        nicheResponse = "That's such important work, helping women!";
                    } else if (lowerInput.includes('entrepreneur') || lowerInput.includes('business')) {
                        nicheResponse = "Love that you're supporting entrepreneurs!";
                    } else if (lowerInput.includes('coach') || lowerInput.includes('mentor')) {
                        nicheResponse = "Coaching work is so impactful!";
                    } else if (lowerInput.includes('health') || lowerInput.includes('wellness') || lowerInput.includes('fitness')) {
                        nicheResponse = "Health and wellness work is so needed!";
                    } else if (lowerInput.includes('creative') || lowerInput.includes('artist') || lowerInput.includes('design')) {
                        nicheResponse = "Creative work brings so much beauty to the world!";
                    } else {
                        nicheResponse = "That sounds like really meaningful work!";
                    }
                    
                    return `${nicheResponse}<br><br><strong>How long have you been in business?</strong>`;
                    
                case 'time_in_business':
                    conversationState.userData.timeInBusiness = input;
                    conversationState.stage = 'revenue';
                    let timeResponse = '';
                    if (input.includes('year')) {
                        if (input.includes('1') || input.includes('one')) {
                            timeResponse = `A year in business - you're building something real!`;
                        } else if (input.includes('2') || input.includes('two')) {
                            timeResponse = `Two years - you've gotten through the hardest part!`;
                        } else if (input.includes('3') || input.includes('three')) {
                            timeResponse = `Three years - that's some serious staying power!`;
                        } else {
                            timeResponse = `${input} - that shows real commitment and persistence!`;
                        }
                    } else {
                        timeResponse = `${input} - that's incredible dedication!`;
                    }
                    setTimeout(() => {
                        showRevenueOptions();
                    }, 500);
                    return `${timeResponse}<br><br><strong>What's your current monthly revenue range?</strong>`;
                    
                case 'main_question':
                    conversationState.userData.mainChallenge = input;
                    conversationState.stage = 'follow_up';
                    return `Got it. What have you tried so far to improve this?`;
                    
                case 'follow_up':
                    conversationState.userData.whatTriedSoFar = input;
                    conversationState.stage = 'waiting_for_next';
                    conversationState.waitingForNextResponse = true;
                    logUserData();
                    return await generatePersonalizedReframe();
                    
                case 'waiting_for_next':
                    if (input.toLowerCase().includes('yes') || input.toLowerCase().includes('sure') || input.toLowerCase().includes('tell me') || input.toLowerCase().includes('what')) {
                        conversationState.stage = 'complete';
                        conversationState.sessionComplete = true;
                        return generateOfferResponse();
                    } else {
                        return `No worries! If you change your mind and want to hear about the solution, just let me know.`;
                    }
                    
                default:
                    if (conversationState.sessionComplete) {
                        return `This session is complete! If you have more questions, I'd love to continue the conversation inside The Million Dollar Plan.<br><br><button class="purchase-btn" onclick="window.open('https://www.chelsiekenyon.com/milliondollarplan', '_blank')">Get The Million Dollar Plan - $27</button>`;
                    }
                    return `I'm not sure I understand. Could you please rephrase that?`;
            }
        }
        
        async function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            
            if (!message || conversationState.sessionComplete) return;
            
            input.disabled = true;
            document.getElementById('sendBtn').disabled = true;
            
            addUserMessage(message);
            input.value = '';
            
            showTyping();
            
            try {
                const response = await processUserInput(message);
                
                setTimeout(() => {
                    hideTyping();
                    addMayaMessage(response);
                    
                    if (!conversationState.sessionComplete) {
                        input.disabled = false;
                        document.getElementById('sendBtn').disabled = false;
                        input.focus();
                    } else {
                        input.style.display = 'none';
                        document.getElementById('sendBtn').style.display = 'none';
                    }
                }, 1500);
                
            } catch (error) {
                hideTyping();
                addMayaMessage("I'm having a technical moment! Please try again.");
                input.disabled = false;
                document.getElementById('sendBtn').disabled = false;
            }
        }
        
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        
        async function generatePersonalizedReframe() {
            const userData = conversationState.userData;
            
            const contextMessage = `Please provide a personalized reframe for this user, but STOP after revealing the Million Dollar Gap. Do not include the offer yet:

Name: ${userData.name}
Industry/Niche: ${userData.niche}  
Time in business: ${userData.timeInBusiness}
Revenue: ${userData.revenue}
Main challenge they want to get better at: ${userData.mainChallenge}
What they've tried so far: ${userData.whatTriedSoFar}

Use the reframe categories and formula provided in your instructions. Include proper paragraph breaks for readability. Add some bold text for emphasis. End by asking "Would you like to hear what's next?"`;

            try {
                const response = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        messages: [{ role: 'user', content: contextMessage }],
                        prompt: MAYA_PROMPT
                    })
                });

                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error || 'API call failed');
                }
                
                return data.message;
                
            } catch (error) {
                console.error('API Error:', error);
                return generateFallbackReframe();
            }
        }
        
        function generateOfferResponse() {
            const userData = conversationState.userData;
            
            let response = `<strong>Great!</strong> Chelsie actually created something specifically for women entrepreneurs like you, desiring to grow beyond tactical improvements.<br><br>`;
            
            response += `It's a private podcast called <strong>'The Million Dollar Plan: How to Build an Aligned Ecosystem'</strong> and you can get access right now for $27.<br><br>`;
            
            response += `In the <strong>3 quick and easy-to-listen-to episodes</strong>, Chelsie walks you through the exact process she takes her private clients through to encapsulate your magic and deliver it to the right person at the right time, so you can <strong>wake up to new sales from work you did last year</strong>.<br><br>`;
            
            response += `If you desire Chelsie's help executing each step, you can apply to work with her directly.<br><br>`;
            
            response += '<button class="purchase-btn" onclick="window.open(\'https://www.chelsiekenyon.com/milliondollarplan\', \'_blank\')">Get The Million Dollar Plan - $27</button><br><br>';
            
            response += `<strong>Ready to close the gap?</strong>`;
            
            return response;
        }
        
        function generateFallbackReframe() {
            const userData = conversationState.userData;
            
            // Interpret their challenge more naturally
            let challenge = userData.mainChallenge.toLowerCase();
            if (challenge.includes('visibility') || challenge.includes('engagement') || challenge.includes('instagram')) {
                challenge = 'growing their social media presence';
            } else if (challenge.includes('launch')) {
                challenge = 'launching';
            } else if (challenge.includes('content')) {
                challenge = 'content creation';
            } else if (challenge.includes('sales') || challenge.includes('sell')) {
                challenge = 'selling';
            } else {
                challenge = 'tactical improvements';
            }
            
            let reframe = `I totally get it, ${userData.name}. Many entrepreneurs in your industry focus on ${challenge}, and you've clearly been putting in the work with everything you've tried.<br><br>`;
            
            reframe += `But constantly trying to perfect tactics keeps you stuck in reactive mode rather than building strategic business architecture.<br><br>`;
            
            reframe += `What if instead of trying to get better at ${challenge}, you built an ecosystem that encapsulates your magic and delivers it to the right person at the right time - so you can <strong>wake up to new sales from work you did last year</strong>?<br><br>`;
            
            reframe += `<strong>Here's the thing</strong> - you're already successful. You know how to create results. But what got you to where you are now isn't going to get you to your next level without burning you out.<br><br>`;
            
            reframe += `I just revealed what I call <strong>the Million Dollar Gap</strong> - the space between tactical improvements and strategic business architecture. Most entrepreneurs stay stuck in tactics because they don't know how to build the architecture.<br><br>`;
            
            reframe += `<strong>Would you like to hear what's next?</strong>`;
            
            return reframe;
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            initializeChat();
        });
    </script>
</body>
</html>
